// To extract shellcode use the bellow command
// $ for i in $(objdump -d helloworld |grep "^ " |cut -f2); do echo -n '\x'$i; done; echo 


#include <stdio.h>
#include <string.h>


unsigned char code[] = \
"\x50\x51\x52\x56\x57\x41\x53\xeb\x39\x2d\x78\x2d\x78\x2d\x78\x2d\x78\x2d\x20\x43\x4f\x4d\x50\x49\x4c\x45\x50\x45\x41\x43\x45\x20\x3a\x20\x43\x75\x74\x65\x20\x6c\x69\x74\x74\x6c\x65\x20\x76\x69\x72\x75\x73\x20\x5e\x5f\x5e\x20\x2d\x78\x2d\x78\x2d\x78\x2d\x78\x2d\x0a\x48\x31\xc0\x48\x83\xc0\x01\x48\x89\xc7\x48\x8d\x35\xb6\xff\xff\xff\x48\x31\xd2\xb2\x39\x0f\x05\x41\x5b\x5f\x5e\x5a\x59\x58\x48\xb8\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xff\xe0";


int main()
{
	printf("Shellcode length : %d \n", (int )strlen(code));	

	int  (*ret)() = (int (*)())code; 

	ret();
}
